#!/bin/bash

# Script de inicializaÃ§Ã£o para produÃ§Ã£o
echo "ğŸš€ Iniciando sistema de aprovaÃ§Ã£o KAEFER..."

# Verificar variÃ¡veis de ambiente obrigatÃ³rias
if [ -z "$MONGODB_URI" ]; then
  echo "âŒ MONGODB_URI nÃ£o configurada!"
  exit 1
fi

if [ -z "$JWT_SECRET" ]; then
  echo "âŒ JWT_SECRET nÃ£o configurada!"
  exit 1
fi

echo "âœ… VariÃ¡veis de ambiente verificadas"

# Criar Ã­ndices MongoDB
echo "ğŸ“Š Criando Ã­ndices MongoDB..."
bundle exec rails db:mongoid:create_indexes

# Criar usuÃ¡rios padrÃ£o se nÃ£o existirem
echo "ğŸ‘¥ Verificando usuÃ¡rios padrÃ£o..."
bundle exec rails db:seed

echo "ğŸ‰ Sistema pronto para uso!"
echo "ğŸ“§ Admin: admin@kaefer.com | Senha: admin123"
echo "ğŸ‘¤ User: user@kaefer.com | Senha: user123"

# Iniciar servidor
bundle exec puma -C config/puma.rb
