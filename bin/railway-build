#!/bin/bash
# Railway build script

set -e

echo "ðŸ”§ Installing system dependencies..."
# Install libyaml for psych gem
if command -v apt-get &> /dev/null; then
    apt-get update && apt-get install -y libyaml-dev
fi

echo "ðŸ“¦ Installing Ruby gems..."
bundle config build.psych --with-libyaml-dir
bundle install

echo "ðŸŽ¨ Precompiling assets..."
bundle exec rails assets:precompile

echo "ðŸ“Š Creating MongoDB indexes..."
bundle exec rails db:mongoid:create_indexes

echo "âœ… Build completed successfully!"
